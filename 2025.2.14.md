
## 模拟赛



### T2

考虑像之前那道题一样将折线图画出来

然后利用JOI那题的trick，枚举最后一次被 clear 的位置在哪里

我们发现 clear 的充要条件是最高进制位被消去，只要没有被 clear 则后半部分的最高位置就是折线图的最高位

那么次高位呢？我们发现当我们确定最高位过后，那么第一个 $1$ 的位置就无关紧要了，所以以它+1的位置作为新的原点建坐标系，递归上述过程即可

如何统计答案呢？我们考虑枚举每一位，于是问题就变成了“答案前缀为 1010101\*\*\*\*\*\*” 的方案数

如何控制前缀为这个呢？其实也就是通过计算出




算了先去部分分了

对于 1-6 的点直接暴力 $f_{i,j}$ 即可，当处理询问时则处理一个前缀的答案和一个后缀的答案，考虑从此处用 0 进行合并，时间复杂度 $O(n2^k)$

对于 $7-14$ 的点，我们发现这样子是支持 $O(n^2k)$ 的


### T3

求

$$\left( \sum_{i=1}^{n} f(a,b,i)  \right) \mod{998244353}$$

其中 $f(a,b,i)$ 表示 $ax \equiv b \pmod{i}$ 的最小整数解

对于 $f(a,b,i)$ ，我们正常的求法是先判断是否有 $gcd(a,i) \mid b$ ，然后再用 $exgcd$ 求解

所以转化为求出 $ax+ik=gcd(a,i)$ 的最小整数解，设其为 $g(a,i)$，然后将其乘上 $\frac{b}{gcd(a,i)}$

所以先令，转化为

$$\begin{eqnarray}

&& \sum_{i=1}^{n}[gcd(a,i)\mid b]g(a,i)\times \frac{b}{gcd(a,i)}

\end{eqnarray}$$




![[sol(3).pdf]]